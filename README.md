# 디스코드 음성 채널 관리 봇

## 프로젝트 소개
이 봇은 디스코드 서버에서 사용자의 요청에 따라 음성 채널을 동적으로 생성하고 관리하는 자동화 봇입니다. **어드민이 지정한 특정 텍스트 채널**에서만 작동하며, 사용자가 슬래시 명령어로 음성 채널을 생성하면 관리용 메시지와 함께 채널이 만들어집니다. 생성된 채널은 10분 이상 비어있을 경우 자동으로 삭제되어 서버를 깔끔하게 유지합니다.

## 주요 기능
- **채널 사용 설정 (어드민/관리자 전용)**
  - `/setchannel`: 명령어를 실행한 텍스트 채널을 봇 사용 가능 채널로 등록합니다.
  - `/unsetchannel`: 등록된 텍스트 채널을 사용 가능 목록에서 제외합니다.
  - `/listchannels`: 봇 사용이 허용된 모든 채널의 목록을 보여줍니다.
- **음성 채널 생성**: `/createvoice` 명령어를 사용하여 음성 채널을 생성합니다. (**허용된 채널에서만 사용 가능**)
  - `name`: 생성할 채널의 이름을 지정합니다.
  - `limit`: 채널의 최대 인원 수를 지정합니다. (0은 무제한)
  - `bitrate`: 생성할 채널의 비트레이트를 지정합니다. (기본 64kbps, 8-96kbps 또는 서버 부스트에 따라 더 높게 설정 가능)
- **인터랙티브 채널 관리**:
  - 채널 생성 시, 채널 정보와 함께 **'채널 삭제'** 버튼이 포함된 메시지가 전송됩니다. (생성자에게만 표시)
  - **채널 생성자**, **어드민** 또는 **서버 관리자**가 채널을 삭제할 수 있습니다.
  - **'채널 삭제'** 버튼을 누르면, 정말로 삭제할지 묻는 확인/취소 버튼이 나타납니다.
  - **'확인'** 버튼을 눌러야만 채널이 최종적으로 삭제됩니다.
- **자동 채널 정리**:
  - 봇이 생성한 음성 채널에 10분 이상 아무도 없으면, 해당 채널은 자동으로 삭제됩니다.
  - 채널이 자동 삭제될 경우, 봇이 보냈던 원본 메시지도 "자동으로 삭제되었습니다" 라는 문구로 수정됩니다.
- **영속적인 데이터 관리**:
  - **허용된 텍스트 채널** 정보는 `allowed_channels.json` 파일에 저장됩니다.
  - **생성된 음성 채널** 정보는 `created_channels.json` 파일에 저장됩니다.
  - 봇이 재시작되어도 이 파일들을 통해 정보를 기억하고, 자동 삭제 및 채널 제한 기능을 계속 수행합니다.

## 환경 변수 설정
이 봇을 실행하려면 디스코드 봇 토큰과 어드민 ID가 필요합니다.

1.  **봇 토큰 설정**: 프로젝트 루트 디렉터리에 `token.env` 파일을 생성하고, 자신의 디스코드 봇 토큰을 추가합니다.
    ```env
    # token.env
    BOT_TOKEN="YOUR_DISCORD_BOT_TOKEN_HERE"
    ```
2.  **어드민 ID 설정**: `admin_id.env` 파일을 생성하고, 봇의 관리자 권한을 가질 사용자의 ID를 추가합니다. 여러 명을 등록하려면 쉼표(`,`)로 구분합니다.
    ```env
    # admin_id.env
    ADMIN_IDS="YOUR_ADMIN_ID_1,YOUR_ADMIN_ID_2"
    ```
    **참고**: 어드민 ID에 등록되지 않아도 각 서버의 관리자 권한(`Administrator`)을 가진 사용자는 봇의 관리 명령어를 사용할 수 있습니다.

3.  **알림 채널 설정 (선택사항)**: `notify.env` 파일을 생성하고, 봇의 상태 및 이벤트 알림을 받을 채널의 ID를 추가합니다.
    ```env
    # notify.env
    NOTIFY_CHANNEL_ID="YOUR_DISCORD_CHANNEL_ID_FOR_NOTIFICATIONS"
    ```

## 사용 방법
1.  `requirements.txt` 파일을 이용해 필요한 라이브러리를 설치합니다.
    ```bash
    pip install -r requirements.txt
    ```
2.  봇을 실행합니다.
    ```bash
    python main.py
    ```

## Ubuntu 서버 배포
Ubuntu 환경에서 봇을 서비스로 등록하여 안정적으로 운영할 수 있습니다. 관련 설정 파일은 `ubuntu/` 디렉터리에 있습니다.

-   `voicebot.service`: `systemd` 서비스 파일 예시입니다. 파일 내의 경로를 실제 프로젝트 위치에 맞게 수정한 후, 다음 명령어를 통해 서비스를 등록하고 실행할 수 있습니다.

    ```bash
    # 서비스 파일 복사
    sudo cp ubuntu/voicebot.service /etc/systemd/system/

    # 서비스 활성화 및 시작
    sudo systemctl enable voicebot.service
    sudo systemctl start voicebot.service
    ```

## 주의 사항
- 모든 `.env` 파일은 `.gitignore`에 포함되어 있으므로 Git 저장소에 업로드되지 않습니다. 개인의 민감한 정보가 외부에 노출되지 않도록 주의하세요.

## Git 관리 제외 파일 (.gitignore)
보안 및 효율적인 버전 관리를 위해 `.gitignore`에 명시된 다음 파일 및 폴더들은 Git 추적에서 제외됩니다.

- **환경 변수 파일**: `token.env`, `admin_id.env`, `notify.env`, `*.env` 등.
- **파이썬 캐시 및 빌드 파일**: `__pycache__/`, `build/`, `dist/` 등.
- **가상 환경 폴더**: `venv/`, `env/` 등.
- **생성된 채널 목록**: `created_channels.json`, `allowed_channels.json`.
- **IDE 설정 파일**: `.vscode/`, `.idea/` 등.
- **운영체제 생성 파일**: `.DS_Store`, `Thumbs.db` 등.